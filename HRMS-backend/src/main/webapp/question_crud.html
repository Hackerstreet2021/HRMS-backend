<!doctype html>
<html>

<head>
	<title>Quistion Console</title>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<!-- jQuery Modal -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
	
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />
	
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
		integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	

	<style>
		.modal p {
			margin: 1em 0;
		}

		.add_form.modal {
			border-radius: 0;
			line-height: 18px;
			padding: 0;
			font-family: "Lucida Grande", Verdana, sans-serif;
		}

		.add_form.modal p {
			padding: 20px 30px;
			border-bottom: 1px solid #ddd;
			margin: 0;
			background: -webkit-gradient(linear, left bottom, left top, color-stop(0, #eee), color-stop(1, #fff));
			overflow: hidden;
		}

		.add_form.modal p:last-child {
			border: none;
		}

		.add_form.modal p label {
			float: left;
			font-weight: bold;
			color: #333;
			font-size: 13px;
			width: 110px;
			line-height: 22px;
		}

		.add_form.modal p input[type="text"],
		.add_form.modal p input[type="submit"] {
			font: normal 12px/18px "Lucida Grande", Verdana;
			padding: 3px;
			border: 1px solid #ddd;
			width: 200px;
		}

		#msg {
			margin: 20px;
			padding: 30px;
			color: #fff;
			font-size: 18px;
			font-weight: bold;
			background: -moz-linear-gradient(top, #2e5764, #1e3d47);
			background: -webkit-gradient(linear, left bottom, left top, color-stop(0, #1e3d47), color-stop(1, #2e5764));
		}
	</style>
	
	
	
	
	<script type="text/javascript">
	
	   //Read all API call
		$(document).ready(function () {
			$.getJSON('http://localhost:4041/HumanResourceManagementSystem/question', function (json) {
				var tr = [];
				for (var i = 0; i < json.length; i++) {
					tr.push('<tr>');
					tr.push('<td>' + json[i].id + '</td>');
					tr.push('<td>' + json[i].question + '</td>');
					tr.push('<td>' + json[i].op1 + '</td>');
					tr.push('<td>' + json[i].op2 + '</td>');
					tr.push('<td>' + json[i].op3 + '</td>');
					tr.push('<td>' + json[i].op4 + '</td>');
					tr.push('<td>' + json[i].ans_option + '</td>');
					tr.push('<td><button class=\'edit\'>Edit</button>&nbsp;&nbsp;<button class=\'delete\' id=' + json[i].id + '>Delete</button></td>');
					tr.push('</tr>');
				}
				$('table').append($(tr.join('')));
				console.log(tr);
			});

			$(document).delegate('#addNew', 'click', function (event) {
				event.preventDefault();
				var question = $('#question').val();
				var op1 = $('#op1').val();
				var op2 = $('#op2').val();
				var op3 = $('#op3').val();
				var op4 = $('#op4').val();
				var ans_option = $('#ans_option').val();





 				//Insert API Call
				$.ajax({
					type: "POST",
					contentType: "application/json; charset=utf-8",
					url: "http://localhost:4041/HumanResourceManagementSystem/question/insert",
					data: JSON.stringify(
						{						
						    'question': question,
							'op1': op1, 
							'op2': op2,
							'op3': op3,
							'op4': op4,
							'ans_option': ans_option
							 
							}),
					

					cache: false,
					success: function (result) {
						console.log(result);
						$("#msg").html("<span style='color: green'>Question added successfully</span>");
						window.setTimeout(function () {location.reload()}, 1000)
					},
					error: function (err) {
						$("#msg").html("<span style='color: red'>question is required</span>");
					}
				});
			});



			//Delete API call
			$(document).delegate('.delete', 'click', function () {
				if (true) {
					var id = $(this).attr('id');
					var parent = $(this).parent().parent();
					$.ajax({
						type: "DELETE",
						url: "http://localhost:4041/HumanResourceManagementSystem/question/delete/" + id,
						cache: false,
						success: function () {
							parent.fadeOut('slow', function () {
								$(this).remove();
						       $("#deletemsg").html("<span style='color: green'>Question deleted successfully</span>");

							});
							location.reload(true)
						},
						error: function () {
							$('#err').html('<span style=\'color:red; font-weight: bold; font-size: 30px;\'>Error deleting record').fadeIn().fadeOut(4000, function () {
								$(this).remove();
							});
						}
					});
				}
			});



			//Edit 
			$(document).delegate('.edit', 'click', function () {
				var parent = $(this).parent().parent();

				var id = parent.children("td:nth-child(1)");
				var question = parent.children("td:nth-child(2)");
				var op1 = parent.children("td:nth-child(3)");
				var op2 = parent.children("td:nth-child(4)");
				var op3 = parent.children("td:nth-child(5)");
				var op4 = parent.children("td:nth-child(6)");
				var ans_option = parent.children("td:nth-child(7)");
				var buttons = parent.children("td:nth-child(8)");

				question.html("<input type='text' id='question' value='" + question.html() + "'/>");
				op1.html("<input type='text' id='op1' value='" + op1.html() + "'/>");
				op2.html("<input type='text' id='op2' value='" + op2.html() + "'/>");
				op3.html("<input type='text' id='op3' value='" + op3.html() + "'/>");
				op4.html("<input type='text' id='op4' value='" + op4.html() + "'/>");
				ans_option.html("<input type='text' id='ans_option' value='" + ans_option.html() + "'/>");
				buttons.html("<button id='save'>Save</button>&nbsp;&nbsp;<button class='delete' id='" + id.html() + "'>Delete</button>");
			});		
			

			$(document).delegate('#save', 'click', function () {
				var parent = $(this).parent().parent();
				
				var id = parent.children("td:nth-child(1)");
				var question = parent.children("td:nth-child(2)");
				var op1 = parent.children("td:nth-child(3)");
				var op2 = parent.children("td:nth-child(4)");
				var op3 = parent.children("td:nth-child(5)");
				var op4 = parent.children("td:nth-child(6)");
				var ans_option = parent.children("td:nth-child(7)");
				var buttons = parent.children("td:nth-child(8)");

				
				
				
				//update API call				
				$.ajax({
					type: "PUT",
					contentType: "application/json; charset=utf-8",
					url: "http://localhost:4041/HumanResourceManagementSystem/question/update",
					data: JSON.stringify({'id': id.html(), 'question': question.children("input[type=text]").val(), 'op1': op1.children("input[type=text]").val(), 'op2': op2.children("input[type=text]").val(), 'op3': op3.children("input[type=text]").val(),'op4': op4.children("input[type=text]").val(),'ans_option': ans_option.children("input[type=text]").val()}),
					cache: false,
					success: function () {
						question.html(question.children("input[type=text]").val());
						op1.html(op1.children("input[type=text]").val());
						op2.html(op2.children("input[type=text]").val());
						op3.html(op3.children("input[type=text]").val());
						op4.html(op4.children("input[type=text]").val());
						ans_option.html(ans_option.children("input[type=text]").val());
						buttons.html("<button class='edit' id='" + id.html() + "'>Edit</button>&nbsp;&nbsp;<button class='delete' id='" + id.html() + "'>Delete</button>");
					},
					error: function () {
						$('#err').html('<span style=\'color:red; font-weight: bold; font-size: 30px;\'>Error updating record').fadeIn().fadeOut(4000, function () {
							$(this).remove();
						});
					}
				});
			});

		});
	</script>
</head>







<body>
	<header>
		<nav class="navbar-expand-md navbar-dark" style="background-color: #004080">
			<div class="text-center">
				<a href="#" class="navbar-brand">Question Console</a>

			</div>
		</nav>
	</header>
	<div class="container"><br>

		<p><a class="btn btn-success"' href="#add" rel="modal:open"> Add New Question</a></p>


	<table border="1" cellspacing="0" cellpadding="5">
		<tr>
			<th>Id</th>
			<th>Question</th>
			<th>Option1</th>
			<th>Option2</th>
			<th>Option3</th>
			<th>Option4</th>
			<th>Answer Option</th>
			<th>Actions</th>
		</tr>
	</table>
	
	
	<form id="add" action="#" class="add_form modal" style="display:none;">
		<div id='msg' />

		<h3>Add a New Question</h3>
		<p>
			<label>Question</label>
			<input type="text" id="question" name="address">
		</p>
		<p>
			<label>Option1</label>
			<input type="text" id="op1" name="email">
		</p>
		<p>
			<label>Option2</label>
			<input type="text" id="op2" name="email">
		</p>
		<p>
			<label>Option3</label>
			<input type="text" id="op3" name="email">
		</p>
		<p>
			<label>Option4</label>
			<input type="text" id="op4" name="email">
		</p>
		<p>
			<label>Answer Option</label>
			<input type="text" id="ans_option" name="email">
		</p>
		
		<p>
			<input type="submit" id="addNew" value="Save">
		</p>
		</form>

	</div>
</body>

</html>